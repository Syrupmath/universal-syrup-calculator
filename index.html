<!DOCTYPE html>
<html>
<head>
    <title>Universal Syrup Calculator by Jeffrey Morgenthaler</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
    <div class="container">
        <h1>Universal Syrup Calculator</h1>
        <p class="author">by <a href="https://jeffreymorgenthaler.com/universal-syrup-calculator/" target="_blank">Jeffrey Morgenthaler</a></p>
        <p>This tool helps you calculate the amount of sugar or water needed to make perfect 2:1 or 1:1 sugar syrups based on the initial weight and Brix of your liquid.</p>
        <p>To get started, weigh your liquid with a <a href="https://amzn.to/3SgPzZM" target="_blank">digital scale</a> and measure its Brix (sugar content percentage) with an <a href="https://amzn.to/46cc4EW" target="_blank">optical refractometer</a> and enter the values below. The calculator will tell you how much additional sugar or water you need to add to achieve your desired syrup consistency.</p>
        
        <div class="input-group">
            <label for="weight">Weight of Liquid (grams):</label>
            <input type="number" id="weight" required>
            <span class="error" id="weightError"></span>
        </div>
        <div class="input-group">
            <label for="brix">Initial Brix (%):</label>
            <input type="number" id="brix" required>
            <span class="error" id="brixError"></span>
        </div>
        <button id="calculateButton" onclick="calculate()">Calculate</button>
        <div class="result" id="result"></div>
    </div>

    <footer>
        <p>If you'd like to support the site, consider <a href="https://jeffreymorgenthaler.com/book/" target="_blank">buying a signed copy</a> of one of my books on cocktails and bartending!</p>
    </footer>

    <script>
        function calculate() {
            const weightInput = document.getElementById('weight');
            const brixInput = document.getElementById('brix');
            const weightError = document.getElementById('weightError');
            const brixError = document.getElementById('brixError');
            const weight = parseFloat(weightInput.value);
            const brix = parseFloat(brixInput.value);
            const brixDecimal = brix / 100;
            const targetBrix2to1 = 0.6667;
            const targetBrix1to1 = 0.5;
            let resultText = '';
            let additionType = ''; // To store whether we need to add sugar or water
            let valid = true;

            // Clear previous error messages
            weightError.textContent = '';
            brixError.textContent = '';

            if (isNaN(weight) || weight <= 0) {
                weightError.textContent = 'Please enter a valid weight.';
                valid = false;
            }
            if (isNaN(brix) || brix <= 0 || brix > 100) {
                brixError.textContent = 'Please enter a valid Brix value (0-100).';
                valid = false;
            }

            if (!valid) {
                return;
            }

            if (isNaN(weight) || isNaN(brixDecimal)) {
                resultText = 'Please enter valid numbers for weight and Brix.';
            } else {
                // For 2:1 Syrup
                let additionalSugar2to1 = 0;
                let additionalWater2to1 = 0;

                if (brixDecimal < targetBrix2to1) {
                    additionalSugar2to1 = (targetBrix2to1 * weight - brixDecimal * weight) / (1 - targetBrix2to1);
                    resultText += `<p>To make a 2:1 syrup, add <span class="highlight">${additionalSugar2to1.toFixed(2)} grams</span> of sugar.</p>`;
                    additionType = 'sugar';
                } else if (brixDecimal > targetBrix2to1) {
                    additionalWater2to1 = (brixDecimal * weight - targetBrix2to1 * weight) / targetBrix2to1;
                    resultText += `<p>To make a 2:1 syrup, add <span class="highlight">${additionalWater2to1.toFixed(2)} grams</span> of water.</p>`;
                    additionType = 'water';
                } else {
                    resultText += '<p>Your liquid already has the perfect Brix for a 2:1 syrup.</p>';
                }

                // For 1:1 Syrup
                let additionalSugar1to1 = 0;
                let additionalWater1to1 = 0;

                if (brixDecimal < targetBrix1to1) {
                    additionalSugar1to1 = (targetBrix1to1 * weight - brixDecimal * weight) / (1 - targetBrix1to1);
                    resultText += `<p>To make a 1:1 syrup, add <span class="highlight">${additionalSugar1to1.toFixed(2)} grams</span> of sugar.</p>`;
                    additionType = 'sugar';
                } else if (brixDecimal > targetBrix1to1) {
                    additionalWater1to1 = (brixDecimal * weight - targetBrix1to1 * weight) / targetBrix1to1;
                    resultText += `<p>To make a 1:1 syrup, add <span class="highlight">${additionalWater1to1.toFixed(2)} grams</span> of water.</p>`;
                    additionType = 'water';
                } else {
                    resultText += '<p>Your liquid already has the perfect Brix for a 1:1 syrup.</p>';
                }

                // Add contextualized instructions based on the addition type
                if (additionType === 'sugar') {
                    resultText += '<p>Heat your liquid and the additional sugar over gentle heat and stir until everything is combined.</p>';
                } else if (additionType === 'water') {
                    resultText += '<p>Heat your liquid and the additional water over gentle heat and stir until everything is combined.</p>';
                }

                resultText += '<p>Allow mixture to cool, store in <a href="https://amzn.to/3Sd2092" target="_blank">squeeze bottles</a>, label, and refrigerate.</p>';
            }

            document.getElementById('result').innerHTML = resultText;
        }

        // Add event listener to trigger the calculate function when Enter key is pressed
        document.getElementById('weight').addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                document.getElementById('calculateButton').click();
            }
        });

        document.getElementById('brix').addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                document.getElementById('calculateButton').click();
            }
        });
    </script>
</body>
</html>
