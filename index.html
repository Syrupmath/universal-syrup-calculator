<!DOCTYPE html>
<html>
<head>
    <title>Universal Syrup Calculator by Jeffrey Morgenthaler</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Universal Syrup Calculator</h1>
        <p>This tool helps you calculate the amount of sugar or water needed to make perfect 2:1 or 1:1 sugar syrups based on the initial weight and Brix of your liquid.</p>
        <p>To get started, weigh your liquid with a <a href="https://amzn.to/3SgPzZM" target="_blank">digital scale</a> and measure its Brix (sugar content percentage) with an <a href="https://amzn.to/46cc4EW" target="_blank">optical refractometer</a> and enter the values below. The calculator will tell you how much additional sugar or water you need to add to achieve your desired syrup consistency.</p>
        
        <div class="input-group">
            <label for="weight">Weight of Liquid (grams):</label>
            <input type="number" id="weight" required>
        </div>
        <div class="input-group">
            <label for="brix">Initial Brix (%):</label>
            <input type="number" id="brix" required>
        </div>
        <button id="calculateButton" onclick="calculate()">Calculate</button>
        <div class="result" id="result"></div>
    </div>

    <script>
        function calculate() {
            const weight = parseFloat(document.getElementById('weight').value);
            const brix = parseFloat(document.getElementById('brix').value) / 100;
            const targetBrix2to1 = 0.6667;
            const targetBrix1to1 = 0.5;
            let resultText = '';
            let additionType = ''; // To store whether we need to add sugar or water

            if (isNaN(weight) || isNaN(brix)) {
                resultText = 'Please enter valid numbers for weight and Brix.';
            } else {
                // For 2:1 Syrup
                let additionalSugar2to1 = 0;
                let additionalWater2to1 = 0;

                if (brix < targetBrix2to1) {
                    additionalSugar2to1 = (targetBrix2to1 * weight - brix * weight) / (1 - targetBrix2to1);
                    resultText += `To make a 2:1 syrup, add ${additionalSugar2to1.toFixed(2)} grams of sugar.<br>`;
                    additionType = 'sugar';
                } else if (brix > targetBrix2to1) {
                    additionalWater2to1 = (brix * weight - targetBrix2to1 * weight) / targetBrix2to1;
                    resultText += `To make a 2:1 syrup, add ${additionalWater2to1.toFixed(2)} grams of water.<br>`;
                    additionType = 'water';
                } else {
                    resultText += 'Your liquid already has the perfect Brix for a 2:1 syrup.<br>';
                }

                // For 1:1 Syrup
                let additionalSugar1to1 = 0;
                let additionalWater1to1 = 0;

                if (brix < targetBrix1to1) {
                    additionalSugar1to1 = (targetBrix1to1 * weight - brix * weight) / (1 - targetBrix1to1);
                    resultText += `To make a 1:1 syrup, add ${additionalSugar1to1.toFixed(2)} grams of sugar.`;
                    additionType = 'sugar';
                } else if (brix > targetBrix1to1) {
                    additionalWater1to1 = (brix * weight - targetBrix1to1 * weight) / targetBrix1to1;
                    resultText += `To make a 1:1 syrup, add ${additionalWater1to1.toFixed(2)} grams of water.`;
                    additionType = 'water';
                } else {
                    resultText += 'Your liquid already has the perfect Brix for a 1:1 syrup.';
                }

                // Add contextualized instructions based on the addition type
                if (additionType === 'sugar') {
                    resultText += '<br><br>Heat your liquid and the additional sugar over gentle heat and stir until everything is combined.<br>';
                } else if (additionType === 'water') {
                    resultText += '<br><br>Heat your liquid and the additional water over gentle heat and stir until everything is combined.<br>';
                }

                resultText += 'Allow mixture to cool, store in squeeze bottles, label, and refrigerate.';
            }

            document.getElementById('result').innerHTML = resultText;
        }

        // Add event listener to trigger the calculate function when Enter key is pressed
        document.getElementById('weight').addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                document.getElementById('calculateButton').click();
            }
        });

        document.getElementById('brix').addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                document.getElementById('calculateButton').click();
            }
        });
    </script>
</body>
</html>
